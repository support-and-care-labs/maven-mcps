//
// Copyright 2025 The Apache Software Foundation
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//

= Mail MCP Detailed Setup
ifndef::env-site[:toc:]
ifndef::env-site[:toclevels: 3]

Advanced configuration and detailed documentation for the Mail MCP server.

For basic setup, see xref:mcp-setup.adoc#_mail_mcp[MCP Setup - Mail MCP].

== Retrieving Both Mailing Lists

The quick start only retrieves dev@maven.apache.org.
To retrieve both lists (dev@ and users@):

[source,bash]
----
# Retrieve dev@ archives (July 2002-present, ~750MB)
for year in $(seq 2002 $(date +%Y)); do
  for month in $(seq -w 1 12); do
    docker compose exec scheduler retrieve-mbox --date ${year}-${month} --output-dir /app/data/dev || true
  done
done

# Retrieve users@ archives (Nov 2002-present, ~800MB)
for year in $(seq 2002 $(date +%Y)); do
  for month in $(seq -w 1 12); do
    docker compose exec scheduler retrieve-mbox --date ${year}-${month} --list users@maven.apache.org --output-dir /app/data/users || true
  done
done

# Index all downloaded mbox files
docker compose exec scheduler index-mbox --directory /app/data/dev/ --list dev@maven.apache.org
docker compose exec scheduler index-mbox --directory /app/data/users/ --list users@maven.apache.org
----

Initial retrieval (~1.5GB total) takes time but only needs to be done once.
The scheduler container automatically updates both lists' archives hourly.

== MCP Configuration Scopes

The quick start uses user-level configuration (`-s user`).
For project-level configuration:

[source,bash]
----
claude mcp add maven-mail -s project --transport http http://localhost:58080/mcp
----

See xref:claude-code-advanced-setup.adoc[Claude Code Advanced Setup] for details on configuration scopes.

== Available Tools

Once configured, the following MCP tools are available:

include::mail-mcp:ROOT:partial$available-tools.adoc[]

== Detailed Documentation

For complete documentation including:

* Data management and indexing
* Development setup
* Architecture details

See xref:mail-mcp::index.adoc[Mail MCP Documentation].

=== Key Pages

* xref:mail-mcp:usage:docker.adoc[Docker Setup] - Full Docker configuration
* xref:mail-mcp:usage:mcp-server.adoc[MCP Server] - Server configuration and tools
* xref:mail-mcp:usage:data-management.adoc[Data Management] - Managing mbox archives

== Related

* xref:mcp-setup.adoc[MCP Setup (Quick Start)]
* xref:components:mail-mcp.adoc[Mail MCP Component Overview]
