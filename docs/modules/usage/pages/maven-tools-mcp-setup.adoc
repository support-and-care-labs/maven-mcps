//
// Copyright 2025 The Apache Software Foundation
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//

= Maven Tools MCP Setup
ifndef::env-site[:toc:]
ifndef::env-site[:toclevels: 3]

Configuration for the Maven Tools MCP server, providing Maven Central dependency intelligence.

For the design rationale, see xref:development:adr/0007-maven-central-search.adoc[ADR-0007: Maven Central Search].

== Overview

The https://github.com/arvindand/maven-tools-mcp[maven-tools-mcp] server provides AI assistants with Maven Central dependency intelligence.
It reads `maven-metadata.xml` files directly from Maven Central, which is faster and more reliable than using search APIs.

=== Key Features

* Get latest or stable versions of dependencies
* Check if specific versions exist
* Bulk version checking for multiple dependencies
* Compare versions with upgrade recommendations
* Dependency age analysis (fresh/current/aging/stale)
* Release pattern analysis and predictions
* Project health scoring

=== Limitations

Class name search::
This MCP does not support finding which artifacts contain a specific class.
For class search, use the xref:_class_name_search_alternative[alternative methods] below.

== Prerequisites

* Docker installed and running
* Claude Code or Claude Desktop

== Quick Start (Claude Code)

Add the MCP server using the Claude CLI:

[source,bash]
----
claude mcp add maven-tools -- docker run -i --rm arvindand/maven-tools-mcp:latest
----

To verify the server was added:

[source,bash]
----
claude mcp list
----

== Manual Configuration

=== Claude Code (Project-Level)

Add to `.mcp.json` in your project root:

[source,json]
----
{
  "mcpServers": {
    "maven-tools": {
      "command": "docker",
      "args": ["run", "-i", "--rm", "arvindand/maven-tools-mcp:latest"]
    }
  }
}
----

=== Claude Desktop

Add to your Claude Desktop configuration file:

* **macOS**: `~/Library/Application Support/Claude/claude_desktop_config.json`
* **Windows**: `%APPDATA%\Claude\claude_desktop_config.json`
* **Linux**: `~/.config/Claude/claude_desktop_config.json`

[source,json]
----
{
  "mcpServers": {
    "maven-tools": {
      "command": "docker",
      "args": ["run", "-i", "--rm", "arvindand/maven-tools-mcp:latest"]
    }
  }
}
----

Restart Claude Desktop after adding the configuration.

== Available Tools

[cols="2,3"]
|===
|Tool |Description

|`get_latest_version`
|Get newest version of a dependency with stability preferences

|`check_version_exists`
|Verify if a specific version exists

|`check_multiple_dependencies`
|Check latest versions for multiple dependencies (bulk operation)

|`compare_dependency_versions`
|Compare current vs latest with upgrade recommendations

|`analyze_dependency_age`
|Classify dependencies as fresh/current/aging/stale

|`analyze_release_patterns`
|Analyze maintenance activity and predict releases

|`get_version_timeline`
|Version timeline with temporal analysis

|`analyze_project_health`
|Comprehensive health analysis for multiple dependencies
|===

== Example Queries

=== Version Lookups

[source]
----
# Get latest version
> What is the latest version of Spring Boot?

# Check if version exists
> Does maven-core 4.0.0 exist?

# Bulk check
> Check versions for org.apache.maven:maven-core, org.apache.maven:maven-model, org.apache.maven:maven-artifact
----

=== Dependency Analysis

[source]
----
# Compare versions
> Compare my current dependency versions:
> org.apache.maven:maven-core:3.9.6
> org.apache.maven:maven-model:3.9.6

# Health check
> Analyze the health of my Maven dependencies

# Release patterns
> What is the release pattern for maven-compiler-plugin?
----

== Image Variants

[cols="2,3"]
|===
|Image Tag |Description

|`arvindand/maven-tools-mcp:latest`
|Default with Context7 documentation integration

|`arvindand/maven-tools-mcp:latest-noc7`
|Without Context7 (for restricted networks)
|===

Use the `-noc7` variant if your network blocks access to `mcp.context7.com`.

== Class Name Search Alternative

The maven-tools-mcp does not support class name search.
For finding which artifacts contain a specific class, use one of these alternatives:

=== Maven Central REST API

[source,bash]
----
# Fully-qualified class name search
curl "https://search.maven.org/solrsearch/select?q=fc:org.apache.maven.project.MavenProject&wt=json&rows=10"

# Simple class name search
curl "https://search.maven.org/solrsearch/select?q=c:MavenProject&wt=json&rows=10"
----

=== mcs CLI Tool

Install via SDKman:

[source,bash]
----
sdk install mcs
----

Then search for classes:

[source,bash]
----
# Fully-qualified class name
mcs class-search -f org.apache.maven.project.MavenProject

# Simple class name
mcs class-search MavenProject
----

== Troubleshooting

=== Context7 Connection Issues

If the server fails to start with a Spring stack trace, your network may be blocking `mcp.context7.com`.
Use the `-noc7` image variant:

[source,json]
----
{
  "mcpServers": {
    "maven-tools": {
      "command": "docker",
      "args": ["run", "-i", "--rm", "arvindand/maven-tools-mcp:latest-noc7"]
    }
  }
}
----

=== Docker Not Running

Ensure Docker is running before starting Claude Code or Claude Desktop.

[source,bash]
----
docker info
----

== Related

* xref:development:adr/0007-maven-central-search.adoc[ADR-0007: Maven Central Search]
* xref:mcp-setup.adoc[MCP Setup (Quick Start)]
* https://github.com/arvindand/maven-tools-mcp[maven-tools-mcp on GitHub]
* https://central.sonatype.org/search/rest-api-guide/[Maven Central REST API]
